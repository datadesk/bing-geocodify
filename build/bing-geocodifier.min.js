!function t(e,s,i){function o(r,l){if(!s[r]){if(!e[r]){var a="function"==typeof require&&require;if(!l&&a)return a(r,!0);if(n)return n(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=s[r]={exports:{}};e[r][0].call(u.exports,function(t){var s=e[r][1][t];return o(s||t)},u,u.exports,t,e,s,i)}return s[r].exports}for(var n="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(t,e,s){var i={callbackCounter:0,head:document.getElementsByTagName("head")[0],fetch:function(t,e){var s="JSONPCallback_"+this.callbackCounter++;window[s]=this.evalJSONP(e),t=t.replace("=JSONPCallback","="+s);var i=document.createElement("script");i.src=t,this.head.appendChild(i)},evalJSONP:function(t){return this.head.removeChild(this.head.childNodes[this.head.childNodes.length-1]),function(e){t(e)}}},o=function(t,e){this.el=document.getElementById(t),this.bingApiUrl="https://dev.virtualearth.net/REST/v1/Locations/",this.bingApiKey=e.key||null,this.results=null,this.filters=e.filters||null,this.selectedResult=null,this.lookupForm=document.createElement("form"),this.lookupForm.id="bing-geocodifier-form",this.lookupForm.className="geocodifier-form",this.textInput=document.createElement("input"),this.textInput.setAttribute("type","text"),this.textInput.setAttribute("autocomplete","off"),this.textInput.className="geocodify-input",e.defaultText?this.textInput.setAttribute("placeholder",e.defaultText):this.textInput.setAttribute("placeholder","Search for an address"),this.dropdown=document.createElement("div"),this.dropdown.className="geocodify-dropdown hidden",this.id="bing-geocodifier-dropdown",this.statusMessage=document.createElement("div"),this.statusMessage.className="geocodify-status hidden",this.statusMessage.id="bing-geocodifier-status",this.lookupForm.appendChild(this.textInput),this.lookupForm.appendChild(this.dropdown),this.lookupForm.appendChild(this.statusMessage),this.el.appendChild(this.lookupForm),e.onClick&&(this.onItemClick=e.onClick);this.lookupForm.addEventListener("keyup",this.onKeyUp.bind(this)),this.lookupForm.addEventListener("click",this.onClick.bind(this)),this.lookupForm.onsubmit=function(){return!1}};o.prototype.onItemClick=function(t){},o.prototype.onClick=function(t){if(-1==this.dropdown.className.indexOf("no-results")){var e=t.target;if("li"===e.tagName.toLowerCase())for(var s,i=e.parentNode.children,o=0;o<i.length;o+=1)e.parentNode.children[o]===t.target&&(s=this.results[o],s.geocodePoints[0].coordinates,this.fillTextInput(s))}},o.prototype.fillTextInput=function(t){this.textInput.value!==t.name&&(this.textInput.value=t.name),this.dropdown.classList.add("hidden"),this.onItemClick(t,t.geocodePoints[0].coordinates)},o.prototype.onKeyUp=function(t){switch(t.keyCode){case 27:this.hideSearchDropDown();break;case 13:t.stopPropagation(),t.preventDefault(),this.triggerKeySelect();break;case 39:this.textInput.selectionStart===this.textInput.value.length&&this.triggerKeySelect();break;case 38:t.stopPropagation(),t.preventDefault(),document.querySelector(".active").classList.remove("active"),this.selectedResult&&this.selectedResult>0?this.selectedResult--:this.selectedResult=this.results.length-1,document.querySelectorAll(".geocodify-dropdown li")[this.selectedResult].classList.add("active");break;case 40:t.stopPropagation(),t.preventDefault(),document.querySelector(".active").classList.remove("active"),this.selectedResult<this.results.length-1?this.selectedResult++:this.selectedResult=0,document.querySelectorAll(".geocodify-dropdown li")[this.selectedResult].classList.add("active");break;default:0===this.textInput.value.length?this.hideSearchDropDown():this.getGeocodeData()}},o.prototype.triggerKeySelect=function(){if(this.results&&this.results.length>-1){var t=this.selectedResult,e=this.results[t];this.fillTextInput(e)}},o.prototype.filterResults=function(t){function e(t){if("[object Array]"===Object.prototype.toString.call(i.filters[o])){for(var e=0;e<i.filters[o].length;e++)if(t.address[o]===i.filters[o][e])return!0;return!1}return t.address[o]===i.filters[o]}var s=t.resourceSets[0].resources,i=this;for(var o in this.filters)s=s.filter(e);return s},o.prototype.buildAutofillList=function(){var t=this.results;if(t.length>0){this.selectedResult=0,this.dropdown.innerHTML="";for(var e=document.createElement("ul"),s=0;s<t.length;s+=1){var i=document.createElement("li");i.textContent=t[s].name,0===s&&i.classList.add("active"),e.appendChild(i)}this.dropdown.appendChild(e),this.dropdown.classList.remove("no-results"),this.dropdown.classList.remove("hidden"),this.statusMessage.classList.add("hidden")}else this.statusMessage.textContent="No results",this.statusMessage.classList.remove("hidden"),this.dropdown.classList.add("no-results"),this.dropdown.classList.add("hidden")},o.prototype.getGeocodeData=function(t){var e=this;if(""!==this.textInput.value.trim())if(this.textInput.value.trim().match(/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/))e.results=[{type:"coordinates",name:this.textInput.value.trim(),geocodePoints:[{coordinates:[parseFloat(this.textInput.value.split(",")[0]),parseFloat(this.textInput.value.split(",")[1])]}]}],e.buildAutofillList();else{var s=this.textInput.value,o=this.bingApiUrl+"?q="+encodeURIComponent(s)+"&key="+this.bingApiKey+"&maxResults=10&jsonp=JSONPCallback";this.statusMessage.textContent="Searching ...",this.statusMessage.classList.remove("hidden"),i.fetch(o,function(t){e.results=e.filterResults(t),e.buildAutofillList()})}},o.prototype.hideSearchDropDown=function(){this.dropdown.innerHTML="",this.dropdown.classList.add("hidden"),this.statusMessage.classList.add("hidden"),this.textInput.value=""},window.BingGeocodifier=o},{}]},{},[1]);