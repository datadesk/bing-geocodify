!function t(e,i,o){function n(r,l){if(!i[r]){if(!e[r]){var a="function"==typeof require&&require;if(!l&&a)return a(r,!0);if(s)return s(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[r]={exports:{}};e[r][0].call(u.exports,function(t){var i=e[r][1][t];return n(i?i:t)},u,u.exports,t,e,i,o)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<o.length;r++)n(o[r]);return n}({1:[function(t,e,i){var o=t("date-now");e.exports=function(t,e,i){function n(){var u=o()-a;u<e&&u>0?s=setTimeout(n,e-u):(s=null,i||(d=t.apply(l,r),s||(l=r=null)))}var s,r,l,a,d;return null==e&&(e=100),function(){l=this,r=arguments,a=o();var u=i&&!s;return s||(s=setTimeout(n,e)),u&&(d=t.apply(l,r),l=r=null),d}}},{"date-now":2}],2:[function(t,e,i){function o(){return(new Date).getTime()}e.exports=Date.now||o},{}],3:[function(t,e,i){var o=(t("debounce"),{callbackCounter:0,head:document.getElementsByTagName("head")[0],fetch:function(t,e){var i="JSONPCallback_"+this.callbackCounter++;window[i]=this.evalJSONP(e),t=t.replace("=JSONPCallback","="+i);var o=document.createElement("script");o.src=t,this.head.appendChild(o)},evalJSONP:function(t){return this.head.removeChild(this.head.childNodes[this.head.childNodes.length-1]),function(e){t(e)}}}),n=function(t,e){this.el=document.getElementById(t),this.bingApiKey=e.key||null,this.results=null,this.filters=e.filters||null,this.selectedResult=null,this.lookupForm=document.createElement("form"),this.lookupForm.id="bing-geocodifier-form",this.lookupForm.className="geocodifier-form",this.textInput=document.createElement("input"),this.textInput.setAttribute("type","text"),this.textInput.setAttribute("autocomplete","off"),this.textInput.className="geocodify-input",e.defaultText?this.textInput.setAttribute("placeholder",e.defaultText):this.textInput.setAttribute("placeholder","Search an address"),this.dropdown=document.createElement("div"),this.dropdown.className="geocodify-dropdown hidden",this.id="bing-geocodifier-dropdown",this.lookupForm.appendChild(this.textInput),this.lookupForm.appendChild(this.dropdown),this.el.appendChild(this.lookupForm),e.onClick&&(this.onItemClick=e.onClick);this.lookupForm.addEventListener("keydown",this.onKeyDown.bind(this)),this.lookupForm.addEventListener("click",this.onClick.bind(this))};n.prototype.bingApiUrl="https://dev.virtualearth.net/REST/v1/Locations/",n.prototype.onItemClick=function(t){},n.prototype.onClick=function(t){var e=t.target;if("li"===e.tagName.toLowerCase())for(var i,o,n=e.parentNode.children,s=0;s<n.length;s+=1)e.parentNode.children[s]===t.target&&(i=this.results[s],o=i.geocodePoints[0].coordinates,this.fillTextInput(i))},n.prototype.fillTextInput=function(t){this.textInput.value!==t.name&&(this.textInput.value=t.name,this.dropdown.classList.add("hidden"),this.onItemClick(t,t.geocodePoints[0].coordinates))},n.prototype.onKeyDown=function(t){switch(t.keyCode){case 27:this.hideSearchDropDown();break;case 13:t.stopPropagation(),t.preventDefault(),this.triggerKeySelect();break;case 39:this.textInput.selectionStart===this.textInput.value.length&&this.triggerKeySelect();break;case 38:t.stopPropagation(),t.preventDefault(),document.querySelector(".active").classList.remove("active"),this.selectedResult&&this.selectedResult>0?this.selectedResult--:this.selectedResult=this.results.length-1,document.querySelectorAll(".geocodify-dropdown li")[this.selectedResult].classList.add("active");break;case 40:t.stopPropagation(),t.preventDefault(),document.querySelector(".active").classList.remove("active"),this.selectedResult<this.results.length-1?this.selectedResult++:this.selectedResult=0,document.querySelectorAll(".geocodify-dropdown li")[this.selectedResult].classList.add("active");break;default:this.getGeocodeData()}},n.prototype.triggerKeySelect=function(){if(this.results&&this.results.length>-1){var t=this.selectedResult,e=this.results[t];this.fillTextInput(e)}},n.prototype.filterResults=function(t){function e(t){return t.address[n]===o.filters[n]}var i=t.resourceSets[0].resources,o=this;for(var n in this.filters)i=i.filter(e);return i},n.prototype.buildAutofillList=function(){var t=this.results;if(t.length>0){this.selectedResult=0,this.dropdown.innerHTML="";for(var e=document.createElement("ul"),i=0;i<t.length;i+=1){var o=document.createElement("li");o.textContent=t[i].name,0===i&&o.classList.add("active"),e.appendChild(o)}this.dropdown.appendChild(e),this.dropdown.classList.remove("hidden")}else this.dropdown.classList.add("hidden")},n.prototype.getGeocodeData=function(t){var e=this;if(""!==this.textInput.value.trim()){var i=this.textInput.value,n=this.bingApiUrl+"?q="+encodeURIComponent(i)+"&key="+this.bingApiKey+"&maxResults=10&jsonp=JSONPCallback";o.fetch(n,function(t){e.results=e.filterResults(t),e.buildAutofillList()})}},n.prototype.hideSearchDropDown=function(){this.dropdown.innerHTML="",this.dropdown.classList.add("hidden"),this.textInput.value=""},window.BingGeocodifier=n},{debounce:1}]},{},[3]);